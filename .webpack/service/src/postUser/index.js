(()=>{"use strict";var e={460:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{d(o.next(e))}catch(e){r(e)}}function s(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.handler=void 0;const i=n(553),r=n(906),a=n(706),s=n(997);t.handler=e=>o(void 0,void 0,void 0,(function*(){try{const t=JSON.parse(e.body||"{}");if(!s.validator.validate(t))return{statusCode:400,body:JSON.stringify({message:"Invalid data"})};const n={TableName:i.tableName,Item:{id:t.id,firstName:t.firstName,lastName:t.lastName,birthDate:t.birthDate,phone_number:t.phoneNumber}};yield(0,r.postUser)(n);const o={TableName:n.TableName,Key:{id:n.Item.id}};yield(0,r.getUser)(o);const d={ClientId:process.env.APP_CLIENT_ID,Username:t.email,Password:t.password,UserAttributes:[{Name:"email",Value:t.email},{Name:"given_name",Value:t.firstName},{Name:"family_name",Value:t.lastName},{Name:"birthdate",Value:t.birthDate},{Name:"phone_number",Value:t.phoneNumber}]};return yield(0,a.signUpUser)(d),{statusCode:201,body:JSON.stringify({id:t.id})}}catch(e){return console.error(e),{statusCode:400,body:JSON.stringify({message:e.message})}}}))},706:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{d(o.next(e))}catch(e){r(e)}}function s(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.signUpUser=t.confirmUser=t.loginUser=void 0;const i=n(336),r=n(553),a=new i.CognitoIdentityServiceProvider({region:r.secondaryRegion});t.loginUser=e=>o(void 0,void 0,void 0,(function*(){return yield a.initiateAuth(e).promise()})),t.confirmUser=e=>o(void 0,void 0,void 0,(function*(){yield a.adminConfirmSignUp(e).promise()})),t.signUpUser=e=>o(void 0,void 0,void 0,(function*(){yield a.signUp(e).promise()}))},906:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{d(o.next(e))}catch(e){r(e)}}function s(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}d((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getUser=t.updateUser=t.postUser=t.dynamoDb=void 0;const i=n(336),r=n(553);t.dynamoDb=new i.DynamoDB.DocumentClient({region:r.mainRegion}),t.postUser=e=>o(void 0,void 0,void 0,(function*(){const n=yield t.dynamoDb.put(e).promise();console.log("Post successful:",n)})),t.updateUser=e=>o(void 0,void 0,void 0,(function*(){yield t.dynamoDb.update(e).promise()})),t.getUser=e=>o(void 0,void 0,void 0,(function*(){const n=yield t.dynamoDb.get(e).promise();n.Item?console.log("Item was inserted:",n.Item):console.log("Item was not found")}))},997:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validator=void 0,t.validator={validate(e){return e?!e.firstName||"string"!=typeof e.firstName||e.firstName.length>20?{valid:!1,error:"Invalid first name."}:!e.lastName||"string"!=typeof e.lastName||e.lastName.length>20?{valid:!1,error:"Invalid last name."}:e.id&&function(e){if("string"!=typeof e)return!1;const t=e.trim();if(!t)return!1;if(!/^\d{9}$/.test(t))return!1;let n=0;for(let e=0;e<9;e++){let o=parseInt(t[e])*(e%2+1);o>9&&(o-=9),n+=o}return n%10==0}(e.id)?e.phone&&(t=e.phone,/^\+9725\d{8}$/.test(t))?!e.password||"string"!=typeof e.password||e.password.length<6?{valid:!1,error:"Password must be a minimum of 6 characters."}:{valid:!0}:{valid:!1,error:"Invalid phone number. It should be in the format +9725XXXXXXXX."}:{valid:!1,error:"Invalid Israeli ID."}:{valid:!1,error:"Data is empty."};var t}}},553:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableName=t.secondaryRegion=t.mainRegion=t.moveoLambdaRole=void 0,t.moveoLambdaRole="arn:aws:iam::779000067130:role/Moveo-LambdaExecutionRole",t.mainRegion="il-central-1",t.secondaryRegion="eu-west-1",t.tableName="idoBar-users"},336:e=>{e.exports=require("aws-sdk")}},t={},n=function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(460),o=exports;for(var i in n)o[i]=n[i];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBTyxFQUFPeEIsTUFBTyxrQkFQMUMsSUFBc0JpQyxDQXFDbEIsRSxjQ3hESjlFLE9BQU9DLGVBQWVDLEVBQVMsYUFBYyxDQUFFWCxPQUFPLElBQ3REVyxFQUFRa0IsVUFBWWxCLEVBQVFtRCxnQkFBa0JuRCxFQUFRNEQsV0FBYTVELEVBQVE2RSxxQkFBa0IsRUFDN0Y3RSxFQUFRNkUsZ0JBQWtCLDJEQUMxQjdFLEVBQVE0RCxXQUFhLGVBQ3JCNUQsRUFBUW1ELGdCQUFrQixZQUMxQm5ELEVBQVFrQixVQUFZLGMsVUNOcEI0RCxFQUFPOUUsUUFBVStFLFFBQVEsVSxHQ0NyQkMsRUFBMkIsQ0FBQyxFQ0U1QkMsRURDSixTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUosRUFBeUJHLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhcEYsUUFHckIsSUFBSThFLEVBQVNFLEVBQXlCRyxHQUFZLENBR2pEbkYsUUFBUyxDQUFDLEdBT1gsT0FIQXNGLEVBQW9CSCxHQUFVSSxLQUFLVCxFQUFPOUUsUUFBUzhFLEVBQVFBLEVBQU85RSxRQUFTa0YsR0FHcEVKLEVBQU85RSxPQUNmLENDbkIwQmtGLENBQW9CLEsiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hd3Mtc2tpbGxzLy4vc3JjL3Bvc3RVc2VyL2luZGV4LnRzIiwid2VicGFjazovL2F3cy1za2lsbHMvLi9zcmMvc2VydmljZXMvY29nbml0by50cyIsIndlYnBhY2s6Ly9hd3Mtc2tpbGxzLy4vc3JjL3NlcnZpY2VzL2R5bmFtb0RCLnRzIiwid2VicGFjazovL2F3cy1za2lsbHMvLi9zcmMvc2VydmljZXMvdmFsaWRhdG9yLnRzIiwid2VicGFjazovL2F3cy1za2lsbHMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLnRzIiwid2VicGFjazovL2F3cy1za2lsbHMvZXh0ZXJuYWwgY29tbW9uanMgXCJhd3Mtc2RrXCIiLCJ3ZWJwYWNrOi8vYXdzLXNraWxscy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9hd3Mtc2tpbGxzL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xuICAgIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7IHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIFAgPyB2YWx1ZSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUodmFsdWUpOyB9KTsgfVxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XG4gICAgfSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5oYW5kbGVyID0gdm9pZCAwO1xuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvY29uc3RhbnRzXCIpO1xuY29uc3QgZHluYW1vREJfMSA9IHJlcXVpcmUoXCIuLi9zZXJ2aWNlcy9keW5hbW9EQlwiKTtcbmNvbnN0IGNvZ25pdG9fMSA9IHJlcXVpcmUoXCIuLi9zZXJ2aWNlcy9jb2duaXRvXCIpO1xuY29uc3QgdmFsaWRhdG9yXzEgPSByZXF1aXJlKFwiLi4vc2VydmljZXMvdmFsaWRhdG9yXCIpO1xuY29uc3QgaGFuZGxlciA9IChldmVudCkgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuYm9keSB8fCBcInt9XCIpO1xuICAgICAgICBpZiAoIXZhbGlkYXRvcl8xLnZhbGlkYXRvci52YWxpZGF0ZShkYXRhKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBtZXNzYWdlOiBcIkludmFsaWQgZGF0YVwiIH0pLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAgICBUYWJsZU5hbWU6IGNvbnN0YW50c18xLnRhYmxlTmFtZSxcbiAgICAgICAgICAgIEl0ZW06IHtcbiAgICAgICAgICAgICAgICBpZDogZGF0YS5pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IGRhdGEuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBkYXRhLmxhc3ROYW1lLFxuICAgICAgICAgICAgICAgIGJpcnRoRGF0ZTogZGF0YS5iaXJ0aERhdGUsXG4gICAgICAgICAgICAgICAgcGhvbmVfbnVtYmVyOiBkYXRhLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgeWllbGQgKDAsIGR5bmFtb0RCXzEucG9zdFVzZXIpKHBhcmFtcyk7XG4gICAgICAgIGNvbnN0IGdldFBhcmFtcyA9IHtcbiAgICAgICAgICAgIFRhYmxlTmFtZTogcGFyYW1zLlRhYmxlTmFtZSxcbiAgICAgICAgICAgIEtleToge1xuICAgICAgICAgICAgICAgIGlkOiBwYXJhbXMuSXRlbS5pZCxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH07XG4gICAgICAgIHlpZWxkICgwLCBkeW5hbW9EQl8xLmdldFVzZXIpKGdldFBhcmFtcyk7XG4gICAgICAgIGNvbnN0IHNpZ25VcFBhcmFtcyA9IHtcbiAgICAgICAgICAgIENsaWVudElkOiBwcm9jZXNzLmVudi5BUFBfQ0xJRU5UX0lELFxuICAgICAgICAgICAgVXNlcm5hbWU6IGRhdGEuZW1haWwsXG4gICAgICAgICAgICBQYXNzd29yZDogZGF0YS5wYXNzd29yZCxcbiAgICAgICAgICAgIFVzZXJBdHRyaWJ1dGVzOiBbXG4gICAgICAgICAgICAgICAgeyBOYW1lOiBcImVtYWlsXCIsIFZhbHVlOiBkYXRhLmVtYWlsIH0sXG4gICAgICAgICAgICAgICAgeyBOYW1lOiBcImdpdmVuX25hbWVcIiwgVmFsdWU6IGRhdGEuZmlyc3ROYW1lIH0sXG4gICAgICAgICAgICAgICAgeyBOYW1lOiBcImZhbWlseV9uYW1lXCIsIFZhbHVlOiBkYXRhLmxhc3ROYW1lIH0sXG4gICAgICAgICAgICAgICAgeyBOYW1lOiBcImJpcnRoZGF0ZVwiLCBWYWx1ZTogZGF0YS5iaXJ0aERhdGUgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIE5hbWU6IFwicGhvbmVfbnVtYmVyXCIsXG4gICAgICAgICAgICAgICAgICAgIFZhbHVlOiBkYXRhLnBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9O1xuICAgICAgICB5aWVsZCAoMCwgY29nbml0b18xLnNpZ25VcFVzZXIpKHNpZ25VcFBhcmFtcyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiAyMDEsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlkOiBkYXRhLmlkIH0pLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiA0MDAsXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSksXG4gICAgICAgIH07XG4gICAgfVxufSk7XG5leHBvcnRzLmhhbmRsZXIgPSBoYW5kbGVyO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuc2lnblVwVXNlciA9IGV4cG9ydHMuY29uZmlybVVzZXIgPSBleHBvcnRzLmxvZ2luVXNlciA9IHZvaWQgMDtcbmNvbnN0IGF3c19zZGtfMSA9IHJlcXVpcmUoXCJhd3Mtc2RrXCIpO1xuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvY29uc3RhbnRzXCIpO1xuY29uc3QgY29nbml0byA9IG5ldyBhd3Nfc2RrXzEuQ29nbml0b0lkZW50aXR5U2VydmljZVByb3ZpZGVyKHtcbiAgICByZWdpb246IGNvbnN0YW50c18xLnNlY29uZGFyeVJlZ2lvbixcbn0pO1xuY29uc3QgbG9naW5Vc2VyID0gKHBhcmFtcykgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgY29uc3QgbG9naW5SZXNwb25zZSA9IHlpZWxkIGNvZ25pdG8uaW5pdGlhdGVBdXRoKHBhcmFtcykucHJvbWlzZSgpO1xuICAgIHJldHVybiBsb2dpblJlc3BvbnNlO1xufSk7XG5leHBvcnRzLmxvZ2luVXNlciA9IGxvZ2luVXNlcjtcbmNvbnN0IGNvbmZpcm1Vc2VyID0gKHBhcmFtcykgPT4gX19hd2FpdGVyKHZvaWQgMCwgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgeWllbGQgY29nbml0by5hZG1pbkNvbmZpcm1TaWduVXAocGFyYW1zKS5wcm9taXNlKCk7XG59KTtcbmV4cG9ydHMuY29uZmlybVVzZXIgPSBjb25maXJtVXNlcjtcbmNvbnN0IHNpZ25VcFVzZXIgPSAocGFyYW1zKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICB5aWVsZCBjb2duaXRvLnNpZ25VcChwYXJhbXMpLnByb21pc2UoKTtcbn0pO1xuZXhwb3J0cy5zaWduVXBVc2VyID0gc2lnblVwVXNlcjtcbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogYWRvcHQocmVzdWx0LnZhbHVlKS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcbiAgICB9KTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmdldFVzZXIgPSBleHBvcnRzLnVwZGF0ZVVzZXIgPSBleHBvcnRzLnBvc3RVc2VyID0gZXhwb3J0cy5keW5hbW9EYiA9IHZvaWQgMDtcbmNvbnN0IGF3c19zZGtfMSA9IHJlcXVpcmUoXCJhd3Mtc2RrXCIpO1xuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvY29uc3RhbnRzXCIpO1xuZXhwb3J0cy5keW5hbW9EYiA9IG5ldyBhd3Nfc2RrXzEuRHluYW1vREIuRG9jdW1lbnRDbGllbnQoe1xuICAgIHJlZ2lvbjogY29uc3RhbnRzXzEubWFpblJlZ2lvbixcbn0pO1xuY29uc3QgcG9zdFVzZXIgPSAocGFyYW1zKSA9PiBfX2F3YWl0ZXIodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcbiAgICBjb25zdCByZXN1bHQgPSB5aWVsZCBleHBvcnRzLmR5bmFtb0RiLnB1dChwYXJhbXMpLnByb21pc2UoKTtcbiAgICBjb25zb2xlLmxvZyhcIlBvc3Qgc3VjY2Vzc2Z1bDpcIiwgcmVzdWx0KTtcbn0pO1xuZXhwb3J0cy5wb3N0VXNlciA9IHBvc3RVc2VyO1xuY29uc3QgdXBkYXRlVXNlciA9IChwYXJhbXMpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IHlpZWxkIGV4cG9ydHMuZHluYW1vRGIudXBkYXRlKHBhcmFtcykucHJvbWlzZSgpO1xufSk7XG5leHBvcnRzLnVwZGF0ZVVzZXIgPSB1cGRhdGVVc2VyO1xuY29uc3QgZ2V0VXNlciA9IChwYXJhbXMpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQgZXhwb3J0cy5keW5hbW9EYi5nZXQocGFyYW1zKS5wcm9taXNlKCk7XG4gICAgaWYgKHJlc3BvbnNlLkl0ZW0pIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJJdGVtIHdhcyBpbnNlcnRlZDpcIiwgcmVzcG9uc2UuSXRlbSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkl0ZW0gd2FzIG5vdCBmb3VuZFwiKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuZ2V0VXNlciA9IGdldFVzZXI7XG4iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMudmFsaWRhdG9yID0gdm9pZCAwO1xuZnVuY3Rpb24gaXNJc3JhZWxpSWRWYWxpZChpZCkge1xuICAgIGlmICh0eXBlb2YgaWQgIT09IFwic3RyaW5nXCIpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBjb25zdCB0cmltbWVkID0gaWQudHJpbSgpO1xuICAgIGlmICghdHJpbW1lZClcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmICghL15cXGR7OX0kLy50ZXN0KHRyaW1tZWQpKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgbGV0IGNvdW50ZXIgPSAwO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgOTsgaSsrKSB7XG4gICAgICAgIGxldCBudW0gPSBwYXJzZUludCh0cmltbWVkW2ldKSAqICgoaSAlIDIpICsgMSk7XG4gICAgICAgIGlmIChudW0gPiA5KVxuICAgICAgICAgICAgbnVtIC09IDk7XG4gICAgICAgIGNvdW50ZXIgKz0gbnVtO1xuICAgIH1cbiAgICByZXR1cm4gY291bnRlciAlIDEwID09PSAwO1xufVxuZnVuY3Rpb24gaXNWYWxpZFBob25lKHBob25lKSB7XG4gICAgY29uc3QgcGF0dGVybiA9IC9eXFwrOTcyNVxcZHs4fSQvO1xuICAgIHJldHVybiBwYXR0ZXJuLnRlc3QocGhvbmUpO1xufVxuZXhwb3J0cy52YWxpZGF0b3IgPSB7XG4gICAgdmFsaWRhdGUoZGF0YSkge1xuICAgICAgICBpZiAoIWRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6IFwiRGF0YSBpcyBlbXB0eS5cIiB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5maXJzdE5hbWUgfHxcbiAgICAgICAgICAgIHR5cGVvZiBkYXRhLmZpcnN0TmFtZSAhPT0gXCJzdHJpbmdcIiB8fFxuICAgICAgICAgICAgZGF0YS5maXJzdE5hbWUubGVuZ3RoID4gMjApIHtcbiAgICAgICAgICAgIHJldHVybiB7IHZhbGlkOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZCBmaXJzdCBuYW1lLlwiIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkYXRhLmxhc3ROYW1lIHx8XG4gICAgICAgICAgICB0eXBlb2YgZGF0YS5sYXN0TmFtZSAhPT0gXCJzdHJpbmdcIiB8fFxuICAgICAgICAgICAgZGF0YS5sYXN0TmFtZS5sZW5ndGggPiAyMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogXCJJbnZhbGlkIGxhc3QgbmFtZS5cIiB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5pZCB8fCAhaXNJc3JhZWxpSWRWYWxpZChkYXRhLmlkKSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCBlcnJvcjogXCJJbnZhbGlkIElzcmFlbGkgSUQuXCIgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRhdGEucGhvbmUgfHwgIWlzVmFsaWRQaG9uZShkYXRhLnBob25lKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IFwiSW52YWxpZCBwaG9uZSBudW1iZXIuIEl0IHNob3VsZCBiZSBpbiB0aGUgZm9ybWF0ICs5NzI1WFhYWFhYWFguXCIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGF0YS5wYXNzd29yZCB8fFxuICAgICAgICAgICAgdHlwZW9mIGRhdGEucGFzc3dvcmQgIT09IFwic3RyaW5nXCIgfHxcbiAgICAgICAgICAgIGRhdGEucGFzc3dvcmQubGVuZ3RoIDwgNikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgZXJyb3I6IFwiUGFzc3dvcmQgbXVzdCBiZSBhIG1pbmltdW0gb2YgNiBjaGFyYWN0ZXJzLlwiLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB2YWxpZDogdHJ1ZSB9O1xuICAgIH0sXG59O1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLnRhYmxlTmFtZSA9IGV4cG9ydHMuc2Vjb25kYXJ5UmVnaW9uID0gZXhwb3J0cy5tYWluUmVnaW9uID0gZXhwb3J0cy5tb3Zlb0xhbWJkYVJvbGUgPSB2b2lkIDA7XG5leHBvcnRzLm1vdmVvTGFtYmRhUm9sZSA9IFwiYXJuOmF3czppYW06Ojc3OTAwMDA2NzEzMDpyb2xlL01vdmVvLUxhbWJkYUV4ZWN1dGlvblJvbGVcIjtcbmV4cG9ydHMubWFpblJlZ2lvbiA9ICdpbC1jZW50cmFsLTEnO1xuZXhwb3J0cy5zZWNvbmRhcnlSZWdpb24gPSAnZXUtd2VzdC0xJztcbmV4cG9ydHMudGFibGVOYW1lID0gJ2lkb0Jhci11c2Vycyc7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhd3Mtc2RrXCIpOyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNDYwKTtcbiJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsImhhbmRsZXIiLCJjb25zdGFudHNfMSIsImR5bmFtb0RCXzEiLCJjb2duaXRvXzEiLCJ2YWxpZGF0b3JfMSIsImV2ZW50IiwiZGF0YSIsIkpTT04iLCJwYXJzZSIsImJvZHkiLCJ2YWxpZGF0b3IiLCJ2YWxpZGF0ZSIsInN0YXR1c0NvZGUiLCJzdHJpbmdpZnkiLCJtZXNzYWdlIiwicGFyYW1zIiwiVGFibGVOYW1lIiwidGFibGVOYW1lIiwiSXRlbSIsImlkIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJiaXJ0aERhdGUiLCJwaG9uZV9udW1iZXIiLCJwaG9uZU51bWJlciIsInBvc3RVc2VyIiwiZ2V0UGFyYW1zIiwiS2V5IiwiZ2V0VXNlciIsInNpZ25VcFBhcmFtcyIsIkNsaWVudElkIiwicHJvY2VzcyIsImVudiIsIkFQUF9DTElFTlRfSUQiLCJVc2VybmFtZSIsImVtYWlsIiwiUGFzc3dvcmQiLCJwYXNzd29yZCIsIlVzZXJBdHRyaWJ1dGVzIiwiTmFtZSIsIlZhbHVlIiwic2lnblVwVXNlciIsImVycm9yIiwiY29uc29sZSIsImNvbmZpcm1Vc2VyIiwibG9naW5Vc2VyIiwiYXdzX3Nka18xIiwiY29nbml0byIsIkNvZ25pdG9JZGVudGl0eVNlcnZpY2VQcm92aWRlciIsInJlZ2lvbiIsInNlY29uZGFyeVJlZ2lvbiIsImluaXRpYXRlQXV0aCIsInByb21pc2UiLCJhZG1pbkNvbmZpcm1TaWduVXAiLCJzaWduVXAiLCJ1cGRhdGVVc2VyIiwiZHluYW1vRGIiLCJEeW5hbW9EQiIsIkRvY3VtZW50Q2xpZW50IiwibWFpblJlZ2lvbiIsInB1dCIsImxvZyIsInVwZGF0ZSIsInJlc3BvbnNlIiwiZ2V0IiwibGVuZ3RoIiwidmFsaWQiLCJ0cmltbWVkIiwidHJpbSIsInRlc3QiLCJjb3VudGVyIiwiaSIsIm51bSIsInBhcnNlSW50IiwiaXNJc3JhZWxpSWRWYWxpZCIsInBob25lIiwibW92ZW9MYW1iZGFSb2xlIiwibW9kdWxlIiwicmVxdWlyZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19leHBvcnRzX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCJdLCJzb3VyY2VSb290IjoiIn0=